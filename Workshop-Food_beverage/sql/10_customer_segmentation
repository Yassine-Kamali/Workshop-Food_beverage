-- 1. Perfil de ingresos por región
-- ¿En qué regiones tenemos clientes con mayor poder adquisitivo?
SELECT 
    region, 
    marital_status, 
    AVG(annual_income) AS avg_annual_income,
    COUNT(customer_id) AS total_customers
FROM silver.customer_demographics_clean
GROUP BY 1, 2
ORDER BY avg_annual_income DESC;
